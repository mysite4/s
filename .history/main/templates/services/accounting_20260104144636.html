{% extends "base.html" %}
{% load static %}
{% block content %}

<link rel="stylesheet" href="{% static 'css/dashboard.css' %}">

<style>
.page-container {
    width: 95%;
    margin: 40px auto;
    font-family: 'Cairo', sans-serif;
}

.page-title {
    text-align: center;
    font-size: 32px;
    font-weight: bold;
    color: #0b1a5b;
}

.table-container {
    background: #fff;
    padding: 20px;
    border-radius: 15px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.1);
    margin-top: 20px;
}

.table {
    width: 100%;
    border-collapse: collapse;
}

.table th,
.table td {
    padding: 12px;
    text-align: center;
    border: 1px solid #ddd;
}

.table thead {
    background: #0b1a5b;
    color: #fff;
}

.badge-paid {
    background: #198754;
    color: #fff;
    padding: 5px 10px;
    border-radius: 8px;
}

.badge-remain {
    background: #dc3545;
    color: #fff;
    padding: 5px 10px;
    border-radius: 8px;
}

.btn-print {
    background: #198754;
    color: #fff;
    border: none;
    padding: 6px 12px;
    border-radius: 8px;
    cursor: pointer;
}
</style>

<div class="page-container">
    <h1 class="page-title">ğŸ“„ Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©</h1>

    <div class="table-container">
        <table class="table">
            <thead>
                <tr>
                    <th>#</th>
                    <th>Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙŠØ¶</th>
                    <th>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
                    <th>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ</th>
                    <th>Ø§Ù„Ù…Ø¯ÙÙˆØ¹</th>
                    <th>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ</th>
                    <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
                    <th>Ø·Ø¨Ø§Ø¹Ø©</th>
                </tr>
            </thead>
            <tbody>
                {% for invoice in invoices %}
                <tr>
                    <td>{{ forloop.counter }}</td>
                    <td>{{ invoice.appointment.name }}</td>
                    <td>{{ invoice.number }}</td>
                    <td>{{ invoice.total_amount }} Ø¯.Ù„</td>
                    <td>
                        <span class="badge-paid">
                            {{ invoice.paid_amount }} Ø¯.Ù„
                        </span>
                    </td>
                    <td>
                        <span class="badge-remain">
                            {{ invoice.remaining_amount }} Ø¯.Ù„
                        </span>
                    </td>
                    <td>{{ invoice.date }}</td>
                    <td>
                        <button class="btn-print" onclick="printInvoice('{{ invoice.id }}')">
                            ğŸ–¨ï¸
                        </button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

<!-- Ù†Ø³Ø®Ø© Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© -->
{% for invoice in invoices %}
<div id="print-{{ invoice.id }}" style="display:none">
    <h2 style="text-align:center">ÙØ§ØªÙˆØ±Ø© Ù…Ø­Ø§Ø³Ø¨Ø©</h2>
    <hr>
    <p><strong>Ø§Ø³Ù… Ø§Ù„Ù…Ø±ÙŠØ¶:</strong> {{ invoice.appointment.name }}</p>
    <p><strong>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</strong> {{ invoice.number }}</p>
    <p><strong>Ø§Ù„Ø¥Ø¬Ù…Ø§Ù„ÙŠ:</strong> {{ invoice.total_amount }} Ø¯.Ù„</p>
    <p><strong>Ø§Ù„Ù…Ø¯ÙÙˆØ¹:</strong> {{ invoice.paid_amount }} Ø¯.Ù„</p>
    <p><strong>Ø§Ù„Ù…ØªØ¨Ù‚ÙŠ:</strong> {{ invoice.remaining_amount }} Ø¯.Ù„</p>
    <p><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> {{ invoice.date }}</p>
</div>
{% endfor %}

<script>
function printInvoice(id) {
    let content = document.getElementById('print-' + id).innerHTML;
    let win = window.open('', '', 'width=600,height=600');
    win.document.write('<html><head><title>ÙØ§ØªÙˆØ±Ø©</title></head><body>');
    win.document.write(content);
    win.document.write('</body></html>');
    win.document.close();
    win.print();
}
</script>

{% endblock %}
