{% extends "base.html" %}
{% load static %}

{% block title %}Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©{% endblock %}

{% block content %}

<style>
/* ====== Ø£Ø²Ø±Ø§Ø± ====== */
.btn-main {
  padding: 6px 12px;
  background: #000;
  color: #fff;
  border: none;
  border-radius: 6px;
  cursor: pointer;
  font-size: 14px;
}

.btn-main:hover {
  background: #333;
}

/* ====== Ø¬Ø¯ÙˆÙ„ ====== */
.table-container {
  overflow-x: auto;
  margin-top: 20px;
}

table {
  width: 100%;
  border-collapse: collapse;
}

th, td {
  border: 1px solid #ddd;
  padding: 8px;
  text-align: center;
}

th {
  background-color: #f5f5f5;
}

/* ====== Ø§Ù„Ø·Ø¨Ø§Ø¹Ø© ====== */
@media print {
  body * {
    visibility: hidden;
  }

  .print-invoice, .print-invoice * {
    visibility: visible;
  }

  .print-invoice {
    position: absolute;
    left: 0;
    top: 0;
    width: 100%;
  }

  .no-print {
    display: none !important;
  }
}
</style>

<div class="container">
  <h2>ğŸ’° ØµÙØ­Ø© Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©</h2>

  <div class="table-container">
    <table>
      <thead>
        <tr>
          <th>#</th>
          <th>Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†</th>
          <th>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©</th>
          <th>Ø§Ù„Ù…Ø¨Ù„Øº</th>
          <th>Ø§Ù„ØªØ§Ø±ÙŠØ®</th>
          <th class="no-print">Ø·Ø¨Ø§Ø¹Ø©</th>
        </tr>
      </thead>
      <tbody>
        {% for invoice in invoices %}
        <tr>
          <td>{{ forloop.counter }}</td>
          <td>{{ invoice.customer_name }}</td>
          <td>{{ invoice.invoice_number }}</td>
          <td>{{ invoice.total_price }}</td>
          <td>{{ invoice.created_at|date:"Y-m-d" }}</td>
          <td class="no-print">
            <button class="btn-main" onclick="printInvoice('{{ invoice.id }}')">
              ğŸ–¨ï¸
            </button>
          </td>
        </tr>

        <!-- ÙØ§ØªÙˆØ±Ø© Ù…Ø®ÙÙŠØ© Ù„Ù„Ø·Ø¨Ø§Ø¹Ø© -->
        <div id="invoice-{{ invoice.id }}" class="print-invoice" style="display:none;">
          <h2>ğŸ§¾ ÙØ§ØªÙˆØ±Ø©</h2>
          <hr>
          <p><strong>Ø§Ø³Ù… Ø§Ù„Ø²Ø¨ÙˆÙ†:</strong> {{ invoice.customer_name }}</p>
          <p><strong>Ø±Ù‚Ù… Ø§Ù„ÙØ§ØªÙˆØ±Ø©:</strong> {{ invoice.invoice_number }}</p>
          <p><strong>Ø§Ù„Ù…Ø¨Ù„Øº:</strong> {{ invoice.total_price }}</p>
          <p><strong>Ø§Ù„ØªØ§Ø±ÙŠØ®:</strong> {{ invoice.created_at|date:"Y-m-d" }}</p>
        </div>

        {% empty %}
        <tr>
          <td colspan="6">Ù„Ø§ ØªÙˆØ¬Ø¯ Ø¨ÙŠØ§Ù†Ø§Øª</td>
        </tr>
        {% endfor %}
      </tbody>
    </table>
  </div>
</div>

<script>
function printInvoice(id) {
  // Ø¥Ø®ÙØ§Ø¡ ÙƒÙ„ Ø§Ù„ÙÙˆØ§ØªÙŠØ±
  document.querySelectorAll('.print-invoice').forEach(el => {
    el.style.display = 'none';
  });

  // Ø¥Ø¸Ù‡Ø§Ø± Ø§Ù„ÙØ§ØªÙˆØ±Ø© Ø§Ù„Ù…Ø·Ù„ÙˆØ¨Ø©
  const invoice = document.getElementById('invoice-' + id);
  invoice.style.display = 'block';

  window.print();

  // Ø¥Ø®ÙØ§Ø¤Ù‡Ø§ Ø¨Ø¹Ø¯ Ø§Ù„Ø·Ø¨Ø§Ø¹Ø©
  invoice.style.display = 'none';
}
</script>

{% endblock %}
