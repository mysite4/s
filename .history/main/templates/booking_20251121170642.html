<!-- services/accounting.html -->
{% extends 'base.html' %}

{% block content %}
<div class="container mt-5">
    <h1 class="mb-4">نظام المحاسبة</h1>

    <table class="table table-bordered table-hover">
        <thead class="table-dark">
            <tr>
                <th>رقم الفاتورة</th>
                <th>اسم المريض</th>
                <th>إجمالي الفاتورة</th>
                <th>المدفوع</th>
                <th>المتبقي</th>
                <th>الدفعات</th>
            </tr>
        </thead>
        <tbody>
            {% for item in accounting_data %}
            <tr {% if item.remaining_amount > 0 %}class="table-warning"{% else %}class="table-success"{% endif %}>
                <td>{{ item.invoice_number }}</td>
                <td>{{ item.patient_name }}</td>
                <td>{{ item.total_amount }} د.ل</td>
                <td>{{ item.paid_amount }} د.ل</td>
                <td>{{ item.remaining_amount }} د.ل</td>
                <td>
                    {% if item.payments %}
                        <ul class="mb-0">
                            {% for payment in item.payments %}
                                <li>{{ payment.amount }} د.ل - {{ payment.paid_at|date:"d/m/Y H:i" }}</li>
                            {% endfor %}
                        </ul>
                    {% else %}
                        لا يوجد دفعات
                    {% endif %}
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}
