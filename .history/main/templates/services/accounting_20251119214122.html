{% extends 'base.html' %}
{% load static %}

{% block title %}ğŸ“Š Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©{% endblock %}

{% block content %}

<section class="accounting-dashboard fade-in">
  <h1 class="page-title">ğŸ“Š Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ Ù„Ù„Ø¹ÙŠØ§Ø¯Ø©</h1>
  <p class="page-subtitle">Ø¹Ø±Ø¶ Ø´Ø§Ù…Ù„ Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø§Ù„ÙŠ (Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·)</p>

  <!-- Cards -->
  <div class="stats-container">
    <div class="stat-card">
      <h3>ğŸ’° Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h3>
      <p>{{ total_income }} Ø¯.Ù„</p>
    </div>

    <div class="stat-card">
      <h3>ğŸ“‰ Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ</h3>
      <p>{{ total_expenses }} Ø¯.Ù„</p>
    </div>

    <div class="stat-card">
      <h3>ğŸ“ˆ ØµØ§ÙÙŠ Ø§Ù„Ø±Ø¨Ø­</h3>
      <p>{{ net_profit }} Ø¯.Ù„</p>
    </div>

    <div class="stat-card">
      <h3>ğŸ§¾ Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h3>
      <p>{{ invoice_count }}</p>
    </div>
  </div>

  <!-- Charts -->
  <div class="charts-wrapper">
    <canvas id="incomeChart"></canvas>
    <canvas id="servicesChart"></canvas>
    <canvas id="profitChart"></canvas>
  </div>

</section>

{% endblock %}

{% block extra_js %}
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
  const incomeChart = new Chart(document.getElementById('incomeChart'), {
    type: 'line',
    data: {
      labels: {{ months|safe }},
      datasets: [{
        label: 'Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø£Ø´Ù‡Ø±',
        data: {{ income_data|safe }},
        borderWidth: 2,
        tension: 0.4,
      }]
    }
  });

  const servicesChart = new Chart(document.getElementById('servicesChart'), {
    type: 'doughnut',
    data: {
      labels: {{ top_services_labels|safe }},
      datasets: [{
        data: {{ top_services_values|safe }},
        borderWidth: 1
      }]
    }
  });

  const profitChart = new Chart(document.getElementById('profitChart'), {
    type: 'bar',
    data: {
      labels: ['Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª', 'Ø§Ù„Ù…ØµØ§Ø±ÙŠÙ', 'Ø§Ù„Ø±Ø¨Ø­'],
      datasets: [{
        data: [{{ total_income }}, {{ total_expenses }}, {{ net_profit }}],
        borderWidth: 1
      }]
    }
  });
</script>

{% endblock %}

<style>
.accounting-dashboard {
  padding: 30px;
}

.stats-container {
  display: grid;
  grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
  gap: 18px;
  margin-bottom: 35px;
}

.stat-card {
  background: #fff;
  padding: 18px;
  border-radius: 14px;
  box-shadow: 0px 4px 12px rgba(0,0,0,0.08);
  text-align: center;
  font-size: 18px;
}

.charts-wrapper {
  display: grid;
  gap: 25px;
}

canvas {
  background: #fff;
  border-radius: 15px;
  padding: 20px;
  box-shadow: 0px 4px 12px rgba(0,0,0,0.05);
}
