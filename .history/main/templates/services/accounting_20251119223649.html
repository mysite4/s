{% extends 'base.html' %}
{% load static %}

{% block title %}ğŸ“Š Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø­Ø§Ø³Ø¨Ø©{% endblock %}

{% block content %}
<section class="accounting-dashboard fade-in">
  <h1 class="page-title">ğŸ“Š Ø§Ù„Ù†Ø¸Ø§Ù… Ø§Ù„Ù…Ø§Ù„ÙŠ Ù„Ù„Ø¹ÙŠØ§Ø¯Ø©</h1>
  <p class="page-subtitle">Ø¹Ø±Ø¶ Ø´Ø§Ù…Ù„ Ù„Ø£Ø¯Ø§Ø¡ Ø§Ù„Ø¹ÙŠØ§Ø¯Ø© Ø§Ù„Ù…Ø§Ù„ÙŠ (Ø§Ù„Ù‚Ø±Ø§Ø¡Ø© ÙÙ‚Ø·)</p>

  <!-- Cards Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª Ø³Ø±ÙŠØ¹Ø© -->
  <div class="stats-container">
    <div class="card">
      <h3>Ø¥Ø¬Ù…Ø§Ù„ÙŠ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª</h3>
      <p>{{ income_data|sum }} Ø±ÙŠØ§Ù„</p>
    </div>
    <div class="card">
      <h3>Ø¹Ø¯Ø¯ Ø§Ù„ÙÙˆØ§ØªÙŠØ±</h3>
      <p>{{ income_data|length }}</p>
    </div>
  </div>

  <!-- Chart -->
  <div class="chart-container" style="margin-top: 30px;">
    <canvas id="incomeChart" width="400" height="200"></canvas>
  </div>
</section>

<!-- Chart.js -->
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

<script>
document.addEventListener("DOMContentLoaded", function() {
    // ØªÙ…Ø±ÙŠØ± Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ù…Ù† Django Ø¨Ø´ÙƒÙ„ Ø¢Ù…Ù†
    const incomeData = JSON.parse('{{ income_data|escapejs }}');
    const invoiceLabels = JSON.parse('{{ invoice_labels|escapejs }}');

    const ctx = document.getElementById('incomeChart').getContext('2d');

    new Chart(ctx, {
        type: 'bar',
        data: {
            labels: invoiceLabels,
            datasets: [{
                label: "ğŸ§¾ Ø§Ù„Ø¥ÙŠØ±Ø§Ø¯Ø§Øª Ø§Ù„Ø´Ù‡Ø±ÙŠØ©",
                data: incomeData,
                backgroundColor: 'rgba(54, 162, 235, 0.5)',
                borderColor: 'rgba(54, 162, 235, 1)',
                borderWidth: 1
            }]
        },
        options: {
            responsive: true,
            plugins: { legend: { display: false } },
            scales: { y: { beginAtZero: true } }
        }
    });
});
</script>

{% endblock %}


<style>
.accounting-dashboard {
    padding: 20px;
}

.stats-container {
    display: flex;
    gap: 20px;
    margin-bottom: 40px;
}

.stat-card {
    background: #f4f4f4;
    padding: 15px 25px;
    border-radius: 8px;
    flex: 1;
    text-align: center;
    box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

.chart-container {
    width: 100%;
    max-width: 800px;
    margin: 0 auto;
}
</style>
{% endblock %}
